{% extends 'Layout.html' %} {% block body%}


<div class="row">
    <div class="col-md-5">

        {% with messages = get_flashed_messages() %} {% if messages %} {% for message in messages %}
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        {% endfor %} {% endif %} {% endwith %}

        <div class="card card-body">
            <form action="/AddVenta" method="POST">

                
                
                <div class="form-group">
                    <select class="form-control" name="idCliente" id="idCliente">
                    {% for cliente in Clientes %}
                        {%if cliente.Estatus=="A"%}
                          <option value="{{cliente.IdCliente}}" selected>{{cliente.Nombre}}</option>
                        {%endif%}
                    {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <select class="form-control" name="idSucursal" id="idSucursal">
                    {% for Sucursal in Sucursales %}
                        {%if Sucursal.estatus=="A"%}
                          <option value="{{Sucursal.idSucursal}}" selected>{{Sucursal.nombre}}</option>
                        {%endif%}
                    {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <select class="form-control" name="idEmpleado" id="idEmpleado">
                    {% for Empleado in Empleados %}
                        {%if Empleado.estatus=="A"%}
                          <option value="{{Empleado.idEmpleado}}" selected>{{Empleado.nombre}}</option>
                        {%endif%}
                    {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <input type="date"  id="fecha" name="fecha" placeholder="Fecha" class="form-control" required>
                </div>

                <div class="form-group">
                    <input type="text"  id="subtotal" name="subtotal" placeholder="subtotal" class="form-control" required>
                </div>

                <div class="form-group">
                    <input step="any" id="iva"  name="iva" placeholder="IVA" maxlength="100" class="form-control" required>
                </div>

                <div class="form-group">
                    <input type="text" id="cantPagada" name="cantPagada" placeholder="Cantidad Pagada" maxlength="200" class="form-control" maxlength="15" required>
                </div>

                <div class="form-group">
                    <input type="text" id="comentarios" name="comentarios" placeholder="Comentarios" maxlength="200" class="form-control" maxlength="15" required>
                </div>

                <div class="form-group">
                    <select class="form-control" name="estatus" id="estatus">
                        <option value="A" selected>Activo</option>
                    </select>
                </div>

                <div class="form-group">
                    <select class="form-control" name="tipo" id="tipo">
                        <option value="C" selected>Contado</option>
                        <option value="P" selected>Credito</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-success btn-block">
                        Guardar
                    </button>
                </div>

            </form>
        </div>
    </div>

    <div class="col-md-7">
        <p>Ventas</p>
        <table class="table table-striped table-bordered bg-white table-sm">
            <thead>
                <tr>
                    <td>IdVenta</td>
                    <td>IdCliente</td>
                    <td>IdSucursal</td>
                    <td>IdEmpleado</td>
                    <td>Fecha</td>
                    <td>SubTotal</td>
                    <td>IVA</td>
                    <td>Total</td>
                    <td>CantidadPagada</td>
                    <td>Comentarios</td>
                    <td>Tipo</td>
                    <td>Estatus</td>
                </tr>
            </thead>
            <tbody>
                {% for cli in Ventas %}
                {%if (cli.idVenta) <= (PosicionA*5) and (cli.idVenta) >= ((PosicionA*5)-4)%}
                <tr>
                    <td>{{cli.idVenta}}       </td>
                    <td>{{cli.Cliente.Nombre}}</td>
                    <td>{{cli.Sucursal.nombre}}       </td>
                    <td>{{cli.Empleado.nombre}} {{cli.Empleado.apellidoPaterno}}       </td>
                    <td>{{cli.fecha}}       </td>
                    <td>{{cli.subtotal}}       </td>
                    <td>{{cli.iva}}       </td>
                    <td>{{cli.total}}       </td>
                    <td>{{cli.cantPagada}}       </td>
                    <td>{{cli.comentarios}}       </td>
                    <td>{{cli.tipo}}       </td>
                    {%if cli.estatus=="A"%}
                        <td>Activo      </td>
                        <td>
                        <a href="/EditVenta/{{cli.idVenta}}" class="btn btn-warning btn-block">Editar</a>
                        <a href="/DeleteVenta/{{cli.idVenta}}" class="btn btn-danger btn-block btn-delete">Eliminar</a>
                        </td>
                        {%else%}
                        <td style="background-color:#FF0000">Inactivo</td>
                        <td>
                            <a href="/EditVenta/{{cli.idVenta}}" class="btn btn-warning btn-block">Editar</a>
                            
                        </td>
                        {%endif%}
                </tr>
                {%endif%}
                {% endfor %}
            </tbody>
        </table>
        
        <nav aria-label="Page navigation example">
            <ul class="pagination">
                {%if PosicionA > 1 %}
              <li class="page-item"><a class="page-link" href="/Ventas/{{PosicionA-1}}">Previous</a></li>
              {% endif %}
              
              {%if PosicionA < PaginasA %}
              <li class="page-item"><a class="page-link" href="/Ventas/{{PosicionA+1}}">Next</a></li>
              {% endif %}
            </ul>
          </nav>
          <h1 align="center">Pagina: {{PosicionA}}</h1>

    </div>
</div>

{% endblock %}